<!-- ================= Complete 2023 - resized google drive videos using overide css video wrapper ================= -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />

<title>2023 Memories</title>

<link rel="stylesheet" href="styles.css">

<style>
/* ================= GENERAL ================= */
body {
  margin:0;
  font-family: Arial, sans-serif;
  background: linear-gradient(135deg, rgba(168,85,247,.18), rgba(255,255,255,.95)),
              repeating-linear-gradient(45deg,#f3e8ff,#f3e8ff 20px,#fff 20px,#fff 40px);
  min-height:100vh;
  overflow-x:hidden;
}

h1 { color:#b492ee; }



/* ================= CARD ================= */
.birthday-card-container {
  width: 360px;   /* Desktop size (UNCHANGED) */
  height: 640px;
  margin: 2rem auto;
  perspective: 1500px;
  position: relative;
}

.card-inner2,
.card-flip,
.card-front,
.card-inner1 {
  position: absolute;
  top:0; left:0;
  width:100%;
  height:100%;
}

.card-inner2 img,
.card-front img,
.card-inner1 img,
.card-photo {
  width:100%;
  height:100%;
  object-fit: cover;
  border-radius: 18px;
}



/* ================= VIDEO ================= */
.video-wrap{
  width:min(95vw,900px);
  margin:0 auto;
  position:relative;
  border-radius:1rem;
  overflow:hidden;
}

.video-wrap iframe{
  position:absolute;
  inset:0;
  width:100%;
  height:100%;
  border:0;
}

.video-16x9{ aspect-ratio:16/9; }
.video-9x16{ aspect-ratio:9/16; width:min(70vw,420px); }

/* Landscape phones: make portrait videos wider */
@media (max-width:900px) and (orientation: landscape) {
  .video-9x16 {
    aspect-ratio: 16/9;
    width: 90vw;
    max-width: 95%;
    height: auto;
  }
}



/* ================= PAGE TITLES & PADDING ================= */
@media (max-width:600px){
  .page h1 {
    font-size: 1.6rem;
    margin: 1rem 0;
    padding: 0 10px;
    text-align: center;
  }

  .back-btn {
    margin: 1rem auto;
    display: block;
  }
}



/* =========================================================
   MOBILE LAYOUT SYSTEM
   (Portrait + Landscape split so landscape can be fixed)
========================================================= */



/* =========================================================
   üì± PORTRAIT  (your working version ‚Äî unchanged)
========================================================= */
@media (max-width:900px) and (orientation: portrait){

  #cardPage{
    display:flex;
    flex-direction:column;
    height:100dvh; /* better than vh on mobile */
    overflow:hidden;
  }

  /* fixed header */
  #cardPage .card-header{
    flex:0 0 auto;
    text-align:center;
    padding:10px 0;
    z-index:5;
  }

  /* scrollable cards */
  #cardPage .birthday-card-wrapper{
    flex:1;
    display:flex;
    flex-direction:row;
    align-items:center;

    gap:20px;

    overflow-x:auto;
    overflow-y:hidden;

    scroll-behavior:smooth;
    scroll-snap-type:x mandatory;

    padding:0 20px;
    box-sizing:border-box;
  }

  /* side spacing to center first/last */
  #cardPage .birthday-card-wrapper::before,
  #cardPage .birthday-card-wrapper::after {
    content:"";
    flex:0 0 calc((100vw - 5px)/2);
  }

  #cardPage .birthday-card-container{
    flex:0 0 auto;
    width:220px;
    height:390px;
    scroll-snap-align:center;
  }
}

/* ================= PORTRAIT VIDEO PAGE ================= */
@media (max-width:900px) and (orientation: portrait) {

  /* page layout */
  .page#videoPage {
      display: flex;
      flex-direction: column;
      min-height: 100dvh;
      padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom); /* safe area for notches */
      box-sizing: border-box;
  }

  /* title/header */
  .page#videoPage h1 {
      flex: 0 0 auto;
      text-align: center;
      margin: 6px 0;
      padding-top: 40px; /* extra top padding so title is fully visible */
  }

  /* video wrapper for 9:16 videos */
  .page#videoPage .video-9x16 {
      flex: 1 1 auto;
      width: 90vw;               /* slightly larger for mobile portrait */
      max-width: 100%;
      height: calc(90vw * 16 / 9); /* maintain 9:16 ratio */
      overflow: visible;          /* allow Drive UI to extend */
      margin: 6px auto;           /* spacing above & below */
  }

  .page#videoPage .video-9x16 iframe {
      width: 100%;
      height: 100%;
      transform: translateX(-1%); /* nudge video to center inside iframe */
  }

  /* back button always visible */
  .page#videoPage .back-btn {
      flex: 0 0 auto;
      margin: 6px auto 12px auto;
  }
}



/* =========================================================
   üì±üì± LANDSCAPE ‚Äî FINAL (no clipping, no centering bug)
========================================================= */
@media (max-width:900px) and (orientation: landscape){

  /* page can scroll vertically instead of clipping */
  .page#cardPage{
    overflow-y:auto;   /* ‚≠ê scroll instead of cut */
    overflow-x:hidden;
  }

  /* scroll area */
  #cardPage .birthday-card-wrapper{
    min-height:0;
    align-items:flex-start; /* no vertical centering */
  }
}


@media (max-width:900px) and (orientation: landscape){

  /* page layout */
  #cardPage{
    display:flex;
    flex-direction:column;
    height:100dvh;
    overflow:hidden;
  }

  /* header fixed */
  #cardPage .card-header{
    flex:0 0 auto;
    padding:6px 0;
    text-align:center;
  }

  /* scroll area */
  #cardPage .birthday-card-wrapper{
    flex:1 1 auto;
    min-height:0;

    display:flex;

    /* ‚≠ê CRITICAL: do NOT center vertically */
    align-items:flex-start;

    overflow-x:auto;
    overflow-y:hidden;

    gap:14px;
    padding:10px 12px 0 12px;

    scroll-behavior:smooth;
    scroll-snap-type:x mandatory;
  }

  /* center first/last horizontally only */
  #cardPage .birthday-card-wrapper::before,
  #cardPage .birthday-card-wrapper::after{
    content:"";
    flex:0 0 calc((100vw - 170px)/2);
  }

  /* card sizing */
  #cardPage .birthday-card-container{
    flex:0 0 auto;

    width:170px;

    /* ‚≠ê height based on real available space */
    height:calc(100dvh - 20px);

    max-height:100%;

    aspect-ratio:360/640;

    scroll-snap-align:center;
  }
}


/* =========================================================
   üé• LANDSCAPE VIDEO & CARD PAGE ‚Äî FIX TITLE + BACK BUTTON
========================================================= */
@media (max-width:900px) and (orientation: landscape) {

  /* video page layout */
  .page#videoPage {
    display: flex;
    flex-direction: column;
    min-height: 0;
    padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom);
    box-sizing: border-box;
  }

  /* title/header */
  .page#videoPage h1 {
    flex: 0 0 auto;
    text-align: center;
    margin: 6px 0;
    padding-top: 60px; /* extra top padding to make it fully visible */
  }

  /* video wrapper for 9:16 videos */
  .page#videoPage .video-9x16 {
    flex: 1 1 auto;
    width: auto;
    height: auto;
    max-height: calc(100vh - 50px - 50px - env(safe-area-inset-top) - env(safe-area-inset-bottom)); 
    /* 50px for title + 50px for back button approx */
    margin: 6px auto;
    overflow-y: auto;
  }

  /* back button always visible */
  .page#videoPage .back-btn {
    flex: 0 0 auto;
    margin: 6px auto 6px auto;
  }
}

/* =========================================================
   üéÑ CHRISTMAS VIDEO PAGE ‚Äî SAME RESPONSIVENESS AS BIRTHDAY
========================================================= */

/* üì± Portrait */
@media (max-width:900px) and (orientation: portrait) {

  .page#christmasVideoPage {
      display: flex;
      flex-direction: column;
      min-height: 100dvh;
      padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom);
      box-sizing: border-box;
  }

  .page#christmasVideoPage h1 {
      flex: 0 0 auto;
      text-align: center;
      margin: 6px 0;
      padding-top: 40px;
  }

  .page#christmasVideoPage .video-9x16 {
      flex: 1 1 auto;
      width: 90vw;
      max-width: 100%;
      height: calc(90vw * 16 / 9);
      overflow: visible;
      margin: 6px auto;
  }

  .page#christmasVideoPage .video-9x16 iframe {
      width: 100%;
      height: 100%;
      transform: translateX(-1%);
  }

  .page#christmasVideoPage .back-btn {
      flex: 0 0 auto;
      margin: 6px auto 12px auto;
  }
}


/* üì±üì± Landscape */
@media (max-width:900px) and (orientation: landscape) {

  .page#christmasVideoPage {
    display: flex;
    flex-direction: column;
    min-height: 0;
    padding: env(safe-area-inset-top) 12px env(safe-area-inset-bottom);
    box-sizing: border-box;
  }

  .page#christmasVideoPage h1 {
    flex: 0 0 auto;
    text-align: center;
    margin: 6px 0;
    padding-top: 60px;
  }

  .page#christmasVideoPage .video-9x16 {
    flex: 1 1 auto;
    width: auto;
    height: auto;
    max-height: calc(100vh - 50px - 50px - env(safe-area-inset-top) - env(safe-area-inset-bottom));
    margin: 6px auto;
    overflow-y: auto;
  }

  .page#christmasVideoPage .back-btn {
    flex: 0 0 auto;
    margin: 6px auto 6px auto;
  }
}


</style>


</head>

<body>

<!-- ================= AUDIO ================= -->
<audio id="birthdayAudio" src="Images/birthday.mp3" loop></audio>
<audio id="christmasAudio" src="Images/christmas.mp3" loop></audio>


<!-- ================= EFFECT LAYERS ================= -->
<div id="snow" class="effect-layer"></div>
<div id="balloonsB" class="effect-layer"></div>



<!-- ================= HOME ================= -->
<div class="card page" id="home" style="display:block;">
  <h1>2023</h1>
  <p>Select an event:</p>
  <button class="logout-btn" onclick="logout()">Logout</button>

  <div class="tiles">
    <div class="tile" onclick="openBirthday()">üéÇ Birthday</div>
    <div class="tile" onclick="openChristmas()">üéÑ Christmas</div>
  </div>

  <button class="back-btn" onclick="goDashboard()">Back</button>
</div>



<!-- ================= BIRTHDAY ================= -->
<div class="card page" id="birthday">
  <h1>2023 Birthday üéÇ</h1>

  <div class="tiles">
    <div class="tile" onclick="openCard()">üíå Card</div>
    <div class="tile" onclick="openVideo()">üé• Video</div>
  </div>

  <button class="back-btn" onclick="goHome()">Back</button>
</div>

<!-- ================= CARD (FULL 2022 ANIMATION COPY) ================= -->
<div class="card page" id="cardPage" style="display:none;">
  <!-- Stationary header -->
  <div class="card-header">
    <h1>Memory Card üíå</h1>
    <button class="back-btn" onclick="openBirthday()">Back</button>
  </div>

  <!-- ‚≠ê Scrollable cards wrapper -->
  <div class="birthday-card-wrapper">
    <div class="birthday-card-container">

      <div class="card-inner2">
        <img src="Images/three.png" class="card-photo">
      </div>

      <div class="card-flip c" id="cardFlip">

        <div class="card-front">
          <img src="Images/one.png" class="card-photo">
        </div>

        <div class="card-inner1">
          <img src="Images/two.png" class="card-photo">
        </div>

      </div>
    </div>
  </div>
</div>



<!-- ================= VIDEO ================= -->
<div class="card page" id="videoPage" style="display:none;">
  <h1>Memory Video üé•</h1>

  <div class="video-wrap video-9x16 birthday-video">
    <iframe
        id="driveVideo"
        src="https://drive.google.com/file/d/11WZc9oFU9wtB9JzRBAPerfkGN-TxiI41/preview"
        frameborder="0" 
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
        allowfullscreen
        style="border-radius:1rem;">
    </iframe>
  </div>
  

  <button class="back-btn" onclick="openBirthday()">Back</button>
</div>



<!-- ================= CHRISTMAS ================= -->
<div class="card page" id="christmas">
  <h1>2023 Christmas üéÑ</h1>

  <div class="tiles">
    <div class="tile tile-christmas-blue" onclick="openChristmasCard()">üíå Card</div>
    <div class="tile tile-christmas-blue" onclick="openChristmasVideo()">üé• Video</div>
  </div>

  <button class="back-btn" onclick="goHome()">Back</button>
</div>

<!-- ================= CHRISTMAS CARD ================= -->
<div class="card page" id="christmasCardPage" style="display:none;">
  <h1>Memory Card üíå</h1>

  <div class="birthday-card-container">
    <div class="card-inner2">
      <img src="Images/christmas-inner2.png" class="card-photo">
    </div>

    <div class="card-flip" id="christmasCardFlip">
      <div class="card-front">
        <img src="Images/christmas-front.png" class="card-photo">
      </div>

      <div class="card-inner1">
        <img src="Images/christmas-inner1.png" class="card-photo">
      </div>
    </div>
  </div>

  <button class="back-btn" onclick="openChristmas()">Back</button>
</div>




<!-- ================= CHRISTMAS VIDEO ================= -->
<div class="card page" id="christmasVideoPage" style="display:none;">
  <h1>Christmas Video üé•</h1>

  <div class="video-wrap video-9x16 christmas-video">
      <iframe 
            id="driveVideo2022"
            src="https://drive.google.com/file/d/1M5CcowDj5OYO9Bs7LHQVhiPqH1qDwr5L/preview"
            frameborder="0" 
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
            allowfullscreen
            style="border-radius:1rem;">
      </iframe>
  </div>



  <button class="back-btn" onclick="openChristmas()">Back</button>
</div>

<!-- ================= PHOTO MODAL (same as 2022) ================= -->
<div class="photo-modal" id="photoModal">
  <span class="photo-close" onclick="closePhoto()">‚úï</span>
  <button class="nav prev" onclick="prevPhoto()">‚ùÆ</button>
  <img id="photoViewer">
  <button class="nav next" onclick="nextPhoto()">‚ùØ</button>
</div>

<!--<script src="auth.js"></script>-->

<script>

/* =====================================================
   GLOBAL
===================================================== */

const snow = document.getElementById("snow");
const balloonsB = document.getElementById("balloonsB");

const bdayAudio = document.getElementById("birthdayAudio");
const xmasAudio = document.getElementById("christmasAudio");

let balloonInterval = null;
let snowInterval = null;



/* =====================================================
   PAGE CONTROL
===================================================== */

function hideAll(){
  document.querySelectorAll(".page").forEach(p=>p.style.display="none");
  stopEffects();
  stopDriveVideos();
}

function goHome(){
  hideAll();
  document.body.classList.remove("christmas-bg");
  document.getElementById("home").style.display="block";
}

function goDashboard(){
  window.location.href = "index.html";
}

function logout(){
  sessionStorage.clear();
  localStorage.clear();
  window.location.replace("login.html");
}

/* =====================================================
   OPEN SECTIONS
===================================================== */

function openBirthday(){
  hideAll();

  document.getElementById("birthday").style.display="block";

  bdayAudio.play();
  startBalloons();
}

function openChristmas(){
  hideAll();

  document.body.classList.add("christmas-bg");
  document.getElementById("christmas").style.display="block";

  xmasAudio.play();
  startSnow();
}

function openCard(){
  hideAll();

  document.getElementById("cardPage").style.display="block";

  //startBalloons();
  flipCard2023();
}

function openVideo(){
  hideAll();

  document.getElementById("videoPage").style.display="block";

  //startBalloons();
}



/* =====================================================
   STOP EVERYTHING WHEN LEAVING PAGE  ‚≠ê
===================================================== */

function stopEffects(){

  /* balloons */
  if(balloonInterval){
    clearInterval(balloonInterval);
    balloonInterval = null;
  }
  balloonsB.innerHTML="";
  balloonsB.style.display="none";

  /* snow */
  if(snowInterval){
    clearInterval(snowInterval);
    snowInterval = null;
  }
  snow.innerHTML="";
  snow.style.display="none";

  /* audio */
  bdayAudio.pause();
  xmasAudio.pause();
  bdayAudio.currentTime=0;
  xmasAudio.currentTime=0;

  /* stop video */
  const iframe = document.getElementById("driveVideo");
  if(iframe) iframe.src = iframe.src;
}

/* =====================================================
   BALLOONS (same as your 2023 main)
===================================================== */

function startBalloons(){

  balloonsB.style.display="block";

  const colors=[
    "#ff6b6b","#fbbf24","#34d399","#60a5fa","#a78bfa","#f472b6"
  ];

  balloonInterval=setInterval(()=>{

    const b=document.createElement("div");
    b.className="balloonB";

    b.style.left=Math.random()*100+"vw";
    b.style.bottom="-40px";
    b.style.background=colors[Math.floor(Math.random()*colors.length)];

    const duration=5+Math.random()*3;
    b.style.animationDuration=duration+"s";

    balloonsB.appendChild(b);

    setTimeout(()=>b.remove(),duration*1000);

  },300);
}



/* =====================================================
   SNOW (same as your Christmas)
===================================================== */

function startSnow(){

  snow.style.display="block";

  snowInterval=setInterval(()=>{

    const s=document.createElement("div");
    s.innerHTML="‚ùÑ";
    s.style.position="absolute";
    s.style.left=Math.random()*100+"vw";
    s.style.animation="fallSnow 5s linear forwards";

    snow.appendChild(s);

    setTimeout(()=>s.remove(),5000);

  },150);
}



/* =====================================================
   RESPONSIVE CARD FLIP FUNCTIONS
===================================================== */

/* Birthday Card Flip */
function flipCard2023() {
  const container = document.getElementById("cardPage");
  const cardFlip = container.querySelector(".card-flip");
  const cardFront = container.querySelector(".card-front");
  const cardInner1 = container.querySelector(".card-inner1");
  const cardInner2 = container.querySelector(".card-inner2");

  // Reset
  cardFlip.style.transition = "none";
  cardFlip.style.transform = "rotateY(0deg)";
  [cardFront, cardInner1, cardInner2].forEach(c => {
    c.classList.remove("card-horizontal");
    c.style.transform = "";
  });

  // Flip animation
  setTimeout(() => {
    cardFlip.style.transition = "transform 0.8s ease-out";
    cardFlip.style.transform = "rotateY(-90deg)";
  }, 300);

  setTimeout(() => {
    cardFlip.style.transition = "transform 0.8s ease-in";
    cardFlip.style.transform = "rotateY(-180deg)";
  }, 1200);

  // Horizontal spread after flip
  setTimeout(() => {
    cardFlip.style.transition = "none";
    cardFlip.style.transform = "none";
    [cardFront, cardInner1, cardInner2].forEach(c => c.classList.add("card-horizontal"));

    // ‚úÖ Adjust spread based on orientation
    let spread;
    if(window.innerWidth <= 900){

      if(window.matchMedia("(orientation: landscape)").matches){
        spread = container.clientWidth * 0.28; // tighter for landscape
      }else{
        spread = container.clientWidth * 0.55; // portrait
      }

    }else{
      spread = container.clientWidth * 0.4; // desktop
    }


    cardFront.style.transform = `translateX(-${spread}px)`;
    cardInner1.style.transform = `translateX(0px)`;
    cardInner2.style.transform = `translateX(${spread}px)`;
  }, 2000);
}


/* ================= CHRISTMAS FUNCTIONS ================= */
function openChristmasCard() {
  hideAll();
  document.body.classList.add("christmas-bg");
  document.getElementById("christmasCardPage").style.display = "block";
  flipChristmasCard();
}

function openChristmasVideo() {
  hideAll();
  document.body.classList.add("christmas-bg");
  document.getElementById("christmasVideoPage").style.display = "block";
}

/* ================= CHRISTMAS CARD FLIP ================= */
/* Christmas Card Flip */
function flipChristmasCard() {
  const container = document.getElementById("christmasCardPage");
  const cardFlip = container.querySelector(".card-flip");
  const cardFront = container.querySelector(".card-front");
  const cardInner1 = container.querySelector(".card-inner1");
  const cardInner2 = container.querySelector(".card-inner2");

  // Reset
  cardFlip.style.transition = "none";
  cardFlip.style.transform = "rotateY(0deg)";
  [cardFront, cardInner1, cardInner2].forEach(c => {
    c.classList.remove("card-horizontal");
    c.style.transform = "";
  });

  // Flip animation
  setTimeout(() => {
    cardFlip.style.transition = "transform 0.8s ease-out";
    cardFlip.style.transform = "rotateY(-90deg)";
  }, 300);

  setTimeout(() => {
    cardFlip.style.transition = "transform 0.8s ease-in";
    cardFlip.style.transform = "rotateY(-180deg)";
  }, 1200);

  // Horizontal spread after flip
  setTimeout(() => {
    cardFlip.style.transition = "none";
    cardFlip.style.transform = "none";
    [cardFront, cardInner1, cardInner2].forEach(c => c.classList.add("card-horizontal"));

    const spread = container.clientWidth * 0.35; // 35% of container width for narrower Xmas card
    cardFront.style.transform = `translateX(-${spread}px)`;
    cardInner1.style.transform = `translateX(0px)`;
    cardInner2.style.transform = `translateX(${spread}px)`;
  }, 2000);
}

function stopDriveVideos(){
  document.querySelectorAll("iframe").forEach(iframe=>{
    const src = iframe.src;
    iframe.src = "";
    iframe.src = src;
  });
}


/* =====================================================
   PHOTO VIEWER (shared like 2022)
===================================================== */

const photoModal = document.getElementById("photoModal");
const photoViewer = document.getElementById("photoViewer");

let photos = [];
let photoIndex = 0;

/* open from any card-photo automatically */
document.addEventListener("click", e => {

  const img = e.target.closest(".card-photo");
  if(!img) return;

  /* only trigger inside card pages */
  if(!img.closest("#cardPage, #christmasCardPage")) return;

  photos = Array.from(
    img.closest(".birthday-card-container").querySelectorAll(".card-photo")
  );

  photoIndex = photos.indexOf(img);

  showPhoto(photoIndex);
  photoModal.style.display = "flex";
});

function showPhoto(i){
  photoViewer.src = photos[i].src;
}

function closePhoto(){
  photoModal.style.display = "none";
}

function nextPhoto(){
  photoIndex = (photoIndex + 1) % photos.length;
  showPhoto(photoIndex);
}

function prevPhoto(){
  photoIndex = (photoIndex - 1 + photos.length) % photos.length;
  showPhoto(photoIndex);
}

/* swipe support */
let startX = 0;

photoModal.addEventListener("touchstart", e=>{
  startX = e.touches[0].clientX;
});

photoModal.addEventListener("touchend", e=>{
  const diff = e.changedTouches[0].clientX - startX;
  if(Math.abs(diff) < 40) return;
  diff < 0 ? nextPhoto() : prevPhoto();
});

</script>
</body>
</html>
