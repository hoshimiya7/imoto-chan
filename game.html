<!-- ================= Functioning desktop canvas enlarged slightly & mobile controls removed ================= -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üéÆ 2026 Birthday Game</title>

<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background: linear-gradient(135deg,#f9a8d4,#c7d2fe);
  color:#4a044e;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
}
.screen{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:2rem;
  z-index:10;
}
.hidden{ display:none; }

.game-box{
  background:rgba(255,255,255,.95);
  backdrop-filter:blur(10px);
  padding:2.5rem;
  border-radius:28px;
  box-shadow:0 12px 32px rgba(0,0,0,.25);
  text-align:center;
  max-width:420px;
  width:100%;
}

button{
  margin:.5rem;
  padding:.7rem 1.4rem;
  border-radius:999px;
  border:none;
  font-weight:bold;
  cursor:pointer;
  color:white;
  background:linear-gradient(135deg,#f472b6,#c084fc);
  transition:.2s;
}
button:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 16px rgba(0,0,0,.35);
}

#gameWrapper{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:1;
}

#gameCanvas{
  display:none;
  background:#fff;
  border-radius:20px;
  box-shadow:0 12px 32px rgba(0,0,0,.25);
}

#hud{
  position:absolute;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  font-weight:bold;
}

#gameOver{ z-index:20; }

#birthdayCode {
  font-weight:bold;
  font-size:18px;
  background:linear-gradient(90deg,#ff69b4,#ffd700,#ff69b4);
  background-size:200% auto;
  background-clip:text;
  -webkit-background-clip:text;
  color:transparent;
  -webkit-text-fill-color:transparent;
  text-shadow:0 0 3px rgba(255,255,255,0.7),0 0 6px rgba(255,182,193,0.5);
  animation: shimmer 2.5s linear infinite;
}
@keyframes shimmer {
  from { background-position: 0% center; }
  to { background-position: 200% center; }
}
</style>
</head>

<body>

<!-- Dashboard -->
<div id="dashboard" class="screen">
  <div class="game-box">
    <h1>üéÆ Birthday Star Run</h1>
    <p>
      ‚≠ê Collect stars (+5)<br>
      ‚õî Avoid obstacles<br>
      ‚¨ÜÔ∏è‚¨áÔ∏è Arrow keys or swipe<br>
      Tap/click to shoot
    </p>
    <h3>üèÜ Highest Score: <span id="highScore">0</span></h3>
    <button onclick="startGame()">‚ñ∂ Play Game</button>
    <button onclick="goBack()">‚¨Ö Back</button>
  </div>
</div>

<!-- Game Area -->
<div id="gameWrapper" class="hidden">
  <canvas id="gameCanvas" width="900" height="350"></canvas>
  <div id="hud" class="hidden">Score: 0</div>
</div>

<!-- Game Over -->
<div id="gameOver" class="screen hidden">
  <div class="game-box">
    <h2>üí• Game Over</h2>
    <p>Your Score: <b id="finalScore"></b></p>
    <button onclick="startGame()">üîÅ Play Again</button>
    <button onclick="showDashboard()">üè† Dashboard</button>
  </div>
</div>

<script>
const canvas=document.getElementById("gameCanvas");
const ctx=canvas.getContext("2d");
const dashboard=document.getElementById("dashboard");
const hud=document.getElementById("hud");
const gameOverScreen=document.getElementById("gameOver");
const finalScoreText=document.getElementById("finalScore");
const highScoreText=document.getElementById("highScore");

let running=false, score=0, speed=6;

const lanes=[80,170,260];
let player={x:120,lane:1,width:80,height:80};
let objects=[], bullets=[];

/* =========================
   Load Images
========================= */
const playerImg=new Image(); playerImg.src="Images/happy.png";
const starImg=new Image(); starImg.src="Images/star.png";

const rockFrames=[];
for(let i=1;i<=4;i++){
  const img=new Image();
  img.src=`Images/bat${i}.png`;
  rockFrames.push(img);
}

const bgFrames=[];
for(let i=1;i<=7;i++){
  const img=new Image();
  img.src=`Images/background${i}.png`;
  bgFrames.push(img);
}

let imagesLoaded=0;
[playerImg,starImg,...rockFrames,...bgFrames].forEach(img=>{
  img.onload=()=>imagesLoaded++;
});

let highScore=localStorage.getItem("birthdayHighScore")||0;
highScoreText.textContent=highScore;


/* =========================
   Responsive Canvas
========================= */
function resizeCanvas(){
  const w=window.innerWidth;
  const h=window.innerHeight;

  const scale=Math.min(w/900,h/350);

  canvas.width=900;
  canvas.height=350;
  canvas.style.width=(900*scale)+"px";
  canvas.style.height=(350*scale)+"px";

  hud.style.fontSize=(16+canvas.clientWidth/60)+"px";
}
window.addEventListener("resize",resizeCanvas);
resizeCanvas();


/* =========================
   Controls
========================= */
document.addEventListener("keydown",e=>{
  if(!running) return;

  if(e.key==="ArrowUp" && player.lane>0) player.lane--;
  if(e.key==="ArrowDown" && player.lane<2) player.lane++;
  if(e.key===" ") shoot();
});

let touchStartY=null;

canvas.addEventListener("touchstart",e=>{
  if(!running) return;
  touchStartY=e.touches[0].clientY;
});

canvas.addEventListener("touchmove",e=>{
  if(!running || touchStartY===null) return;

  const delta=e.touches[0].clientY-touchStartY;

  if(delta<-30 && player.lane>0){
    player.lane--;
    touchStartY=e.touches[0].clientY;
  }
  else if(delta>30 && player.lane<2){
    player.lane++;
    touchStartY=e.touches[0].clientY;
  }
});

canvas.addEventListener("touchend",()=>shoot());
canvas.addEventListener("click",shoot);


/* =========================
   Game Flow
========================= */
function startGame(){
  if(imagesLoaded<(2+rockFrames.length+bgFrames.length)){
    alert("Loading images...");
    return;
  }

  dashboard.style.display="none";
  gameOverScreen.style.display="none";

  document.getElementById("gameWrapper").style.display="flex";
  hud.style.display="block";
  canvas.style.display="block";

  score=0;
  speed=6;
  objects=[];
  bullets=[];
  running=true;

  resizeCanvas();
  loop();
}

function endGame(){
  running=false;

  document.getElementById("gameWrapper").style.display="none";
  hud.style.display="none";
  canvas.style.display="none";

  finalScoreText.textContent=score;

  if(score>highScore){
    highScore=score;
    localStorage.setItem("birthdayHighScore",highScore);
  }

  highScoreText.textContent=highScore;
  gameOverScreen.style.display="flex";
}

function showDashboard(){
  gameOverScreen.style.display="none";
  dashboard.style.display="flex";
}

function goBack(){
  window.location.href="2026.html?birthday=1";
}


/* =========================
   Game Logic
========================= */
function spawn(){
  const lane=Math.floor(Math.random()*3);
  const type=Math.random()<0.65?"star":"rock";
  objects.push({x:canvas.width+20,lane,type,size:60,frame:0});
}

function shoot(){
  bullets.push({x:player.x+player.width/2,y:lanes[player.lane],radius:8,speed:10});
}

let lastSpawn=0;

function loop(){
  if(!running) return;

  ctx.clearRect(0,0,canvas.width,canvas.height);

  bullets.forEach(b=>b.x+=b.speed);

  if(performance.now()-lastSpawn>800){
    spawn();
    lastSpawn=performance.now();
  }

  hud.textContent="Score: "+score;

  requestAnimationFrame(loop);
}
</script>

</body>
</html>
