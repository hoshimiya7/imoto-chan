<!-- ================= Functioning game mobile friendly ================= -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>üéÆ 2026 Birthday Game</title>
<style>
body{
  margin:0;
  font-family:Arial,sans-serif;
  background: linear-gradient(135deg,#f9a8d4,#c7d2fe);
  color:#4a044e;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  overflow:hidden;
}
.screen{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  padding:2rem;
  z-index:10;
}
.hidden{ display:none; }
.game-box{
  background:rgba(255,255,255,.95);
  backdrop-filter:blur(10px);
  padding:2.5rem;
  border-radius:28px;
  box-shadow:0 12px 32px rgba(0,0,0,.25);
  text-align:center;
  max-width:420px;
  width:100%;
}
button{
  margin:.5rem;
  padding:.7rem 1.4rem;
  border-radius:999px;
  border:none;
  font-weight:bold;
  cursor:pointer;
  color:white;
  background:linear-gradient(135deg,#f472b6,#c084fc);
  transition:.2s;
}
button:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 16px rgba(0,0,0,.35);
}
#gameWrapper{
  position:absolute;
  inset:0;
  display:flex;
  justify-content:center;
  align-items:center;
  z-index:1;
}
#gameCanvas{
  display:none;
  background:#fff;
  border-radius:20px;
  box-shadow:0 12px 32px rgba(0,0,0,.25);
  width:100%;
  max-width:900px;
  height:auto;
}
#hud{
  position:absolute;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  font-weight:bold;
  font-size: calc(16px + 1vw);
}
#gameOver{ z-index:20; }
#birthdayCode {
  font-weight: bold;
  font-size: 18px;
  background: linear-gradient(90deg, #ff69b4, #ffd700, #ff69b4);
  background-size: 200% auto;
  background-clip: text;
  -webkit-background-clip: text;
  color: transparent;
  -webkit-text-fill-color: transparent;
  text-shadow: 0 0 3px rgba(255,255,255,0.7), 0 0 6px rgba(255,182,193,0.5);
  animation: shimmer 2.5s linear infinite;
}
@keyframes shimmer {
  from { background-position: 0% center; }
  to { background-position: 200% center; }
}

/* ================= Mobile Controls ================= */
#mobileControls{
  position:absolute;
  bottom:20px;
  left:50%;
  transform:translateX(-50%);
  display:flex;
  gap:15px;
  z-index:30;
}
#mobileControls button{
  width:60px;
  height:60px;
  font-size:24px;
  padding:0;
}
</style>
</head>
<body>

<!-- Dashboard -->
<div id="dashboard" class="screen">
  <div class="game-box">
    <h1>üéÆ Birthday Star Run</h1>
    <p>
      ‚≠ê Collect stars (+5)<br>
      ‚õî Avoid obstacles<br>
      ‚¨ÜÔ∏è‚¨áÔ∏è Arrow keys, swipe, or mobile buttons<br>
      Tap/click to shoot
    </p>
    <h3>üèÜ Highest Score: <span id="highScore">0</span></h3>
    <button onclick="startGame()">‚ñ∂ Play Game</button>
    <button onclick="goBack()">‚¨Ö Back</button>
  </div>
</div>

<!-- Game Area -->
<div id="gameWrapper" class="hidden">
  <canvas id="gameCanvas" width="900" height="350"></canvas>
  <div id="hud" class="hidden">Score: 0</div>
</div>

<!-- Mobile Controls -->
<div id="mobileControls" class="hidden">
  <button id="upBtn">‚¨Ü</button>
  <button id="downBtn">‚¨á</button>
  <button id="shootBtn">üî•</button>
</div>

<!-- Game Over -->
<div id="gameOver" class="screen hidden">
  <div class="game-box">
    <h2>üí• Game Over</h2>
    <p>Your Score: <b id="finalScore"></b></p>
    <button onclick="startGame()">üîÅ Play Again</button>
    <button onclick="showDashboard()">üè† Dashboard</button>
  </div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const dashboard = document.getElementById("dashboard");
const hud = document.getElementById("hud");
const gameOverScreen = document.getElementById("gameOver");
const finalScoreText = document.getElementById("finalScore");
const highScoreText = document.getElementById("highScore");
const mobileControls = document.getElementById("mobileControls");
const upBtn = document.getElementById("upBtn");
const downBtn = document.getElementById("downBtn");
const shootBtn = document.getElementById("shootBtn");

let running=false, score=0, speed=6;
const lanes=[80,170,260];
let player={x:120, lane:1, width:80, height:80};
let objects=[], bullets=[];

// =========================
// Load Images
// =========================
const playerImg=new Image(); playerImg.src="Images/happy.png";
const starImg=new Image(); starImg.src="Images/star.png";
const rockFrames=[];
for(let i=1;i<=4;i++){ const img=new Image(); img.src=`Images/bat${i}.png`; rockFrames.push(img); }
const bgFrames=[];
for(let i=1;i<=7;i++){ const img=new Image(); img.src=`Images/background${i}.png`; bgFrames.push(img); }
let imagesLoaded=0;
[playerImg, starImg, ...rockFrames, ...bgFrames].forEach(img=>{ img.onload=()=>{ imagesLoaded++; } });

// High Score
let highScore=localStorage.getItem("birthdayHighScore")||0;
highScoreText.textContent=highScore;

// =========================
// Responsive Canvas
// =========================
function resizeCanvas(){
  const wrapper=document.getElementById("gameWrapper");
  const width=wrapper.clientWidth;
  const height=width*(350/900);
  canvas.width=900; canvas.height=350;
  canvas.style.width=width+"px";
  canvas.style.height=height+"px";
}
window.addEventListener("resize", resizeCanvas);
resizeCanvas();

function getLaneY(lane){ return lanes[lane]*(canvas.height/350); }

// =========================
// Controls
// =========================
document.addEventListener("keydown", e=>{
  if(!running) return;
  if(e.key==="ArrowUp" && player.lane>0) player.lane--;
  if(e.key==="ArrowDown" && player.lane<2) player.lane++;
  if(e.key===" ") shoot();
});

// Touch swipe
let touchStartY=null;
canvas.addEventListener("touchstart", e=>{ if(!running) return; if(e.touches.length===1) touchStartY=e.touches[0].clientY; });
canvas.addEventListener("touchmove", e=>{
  if(!running || touchStartY===null) return;
  const deltaY=e.touches[0].clientY-touchStartY;
  if(deltaY<-30 && player.lane>0){ player.lane--; touchStartY=e.touches[0].clientY; }
  else if(deltaY>30 && player.lane<2){ player.lane++; touchStartY=e.touches[0].clientY; }
});
canvas.addEventListener("touchend", e=>{ if(!running) return; if(e.changedTouches.length===1) shoot(); touchStartY=null; });
canvas.addEventListener("click", shoot);

// =========================
// Mobile Buttons
// =========================
upBtn.addEventListener("touchstart", ()=>{ if(player.lane>0) player.lane--; });
downBtn.addEventListener("touchstart", ()=>{ if(player.lane<2) player.lane++; });
shootBtn.addEventListener("touchstart", shoot);

// Show/hide mobile controls based on screen width
function showMobileControls(){ if(window.innerWidth<=768) mobileControls.classList.remove("hidden"); }
function hideMobileControls(){ mobileControls.classList.add("hidden"); }

// =========================
// Game Flow
// =========================
function startGame(){
  if(imagesLoaded<(2+rockFrames.length+bgFrames.length)){ alert("Loading images..."); return; }
  dashboard.classList.add("hidden");
  gameOverScreen.classList.add("hidden");
  document.getElementById("gameWrapper").classList.remove("hidden");
  hud.classList.remove("hidden");
  canvas.style.display="block";
  score=0; speed=6; objects=[]; bullets=[]; running=true;
  showMobileControls();
  loop();
}

function endGame(){
  running=false;
  document.getElementById("gameWrapper").classList.add("hidden");
  hud.classList.add("hidden");
  canvas.style.display="none";
  hideMobileControls();
  finalScoreText.textContent=score;
  if(score>highScore){ highScore=score; localStorage.setItem("birthdayHighScore", highScore); }
  highScoreText.textContent=highScore;

  const gameBox=gameOverScreen.querySelector(".game-box");
  let message=document.getElementById("gameOverMessage");
  if(!message){
    message=document.createElement("p");
    message.id="gameOverMessage";
    message.style.margin="1rem 0";
    message.style.fontWeight="bold";
    message.style.fontSize="16px";
    gameBox.insertBefore(message, gameBox.querySelector("button"));
  }
  if(score>=100){ message.innerHTML=`üéâ Congrats! Code: <span id="birthdayCode">HAPPYBIRTHDAY2026</span>`; }
  else{ message.textContent="üëç Great try! Keep going!"; }
  gameOverScreen.classList.remove("hidden");
}

function showDashboard(){ gameOverScreen.classList.add("hidden"); dashboard.classList.remove("hidden"); }
function goBack(){ window.location.href="2026.html?birthday=1"; }

// =========================
// Spawn & Draw
// =========================
function spawn(){ const lane=Math.floor(Math.random()*3); const type=Math.random()<0.65?"star":"rock"; objects.push({x:canvas.width+20, lane, type, size:60, frame:0}); }
function drawBg(){ ctx.drawImage(bgFrames[bgIndex],0,0,canvas.width,canvas.height); bgTimer++; if(bgTimer>=7){ bgIndex=(bgIndex+1)%bgFrames.length; bgTimer=0; } }

let bgIndex=0, bgTimer=0;

function drawPlayer(){
  ctx.save(); ctx.shadowColor="rgba(255,215,0,0.8)"; ctx.shadowBlur=20; ctx.shadowOffsetX=0; ctx.shadowOffsetY=0;
  const ratio=canvas.height/350;
  ctx.drawImage(playerImg, player.x-ratio*player.width/2, getLaneY(player.lane)-ratio*player.height/2, ratio*player.width, ratio*player.height);
  ctx.restore();
}

function drawObject(o){
  const ratio=canvas.height/350;
  if(o.type==="star") ctx.drawImage(starImg, o.x-ratio*o.size/2, getLaneY(o.lane)-ratio*o.size/2, o.size*ratio, o.size*ratio);
  else{ const frameImg=rockFrames[o.frame]; ctx.drawImage(frameImg, o.x-ratio*o.size/2, getLaneY(o.lane)-ratio*o.size/2, o.size*ratio, o.size*ratio); o.frameTimer=(o.frameTimer||0)+1; if(o.frameTimer>=8){ o.frame=(o.frame+1)%rockFrames.length; o.frameTimer=0; } }
}

// =========================
// Bullets
// =========================
function shoot(){ bullets.push({x:player.x+player.width/2, y:getLaneY(player.lane), radius:8, speed:10}); }
function drawBullets(){
  ctx.fillStyle="rgba(255,0,0,0.9)";
  const ratio=canvas.height/350;
  bullets.forEach((b,i)=>{
    ctx.beginPath(); ctx.arc(b.x*ratio,b.y,b.radius*ratio,0,Math.PI*2); ctx.fill();
    b.x+=b.speed;
    objects.forEach((o,j)=>{ if(o.type==="rock"){ const dx=b.x-o.x,dy=b.y-getLaneY(o.lane); const dist=Math.sqrt(dx*dx+dy*dy); if(dist<b.radius+o.size/2){ bullets.splice(i,1); objects.splice(j,1); score+=10; } } });
    if(b.x>canvas.width+20) bullets.splice(i,1);
  });
}

// =========================
// Game Loop
// =========================
let lastSpawn=0;
function loop(){
  if(!running) return;
  drawBg(); drawPlayer(); drawBullets();
  if(performance.now()-lastSpawn>800){ spawn(); lastSpawn=performance.now(); }
  objects.forEach((o,i)=>{
    o.x-=speed; drawObject(o);
    if(Math.abs(o.x-player.x)<30 && o.lane===player.lane){ if(o.type==="star"){ score+=5; objects.splice(i,1); } else{ endGame(); } }
    if(o.x<-50) objects.splice(i,1);
  });
  hud.textContent="Score: "+score;
  speed+=0.002;
  requestAnimationFrame(loop);
}
</script>
</body>
</html>
